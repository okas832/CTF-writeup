import idc
import idaapi

start_addr = 0x194C

arr = [33, 255, 255, 255, 255, 187, 51, 35, 190, 68, 156, 4, 157, 34, 210, 82, 74, 249, 161, 98, 57, 232, 230, 112, 215, 37, 253, 102, 87, 244, 242, 124, 219, 42, 209, 114, 228, 17, 222, 161, 57, 239, 231, 145, 80, 190, 36, 254, 62, 54, 52, 29, 149, 44, 123, 132, 188, 122, 187, 36, 49, 248, 129, 226, 216, 161, 23, 49, 255, 252, 135, 254, 220, 197, 51, 191, 4, 152, 236, 22, 44, 89, 185, 5, 97, 54, 250, 26, 208, 134, 22, 50, 238, 76, 142, 79, 5, 227, 50, 193, 42, 224, 170, 99, 162, 63, 54, 205, 62, 228, 198, 159, 166, 92, 91, 113, 203, 248, 202, 211, 178, 105, 239, 134, 40, 21, 55, 225, 208, 150, 60, 11, 189, 91, 187, 231, 236, 170, 80, 183, 201, 113, 72, 4, 137, 31, 87, 197, 229, 141, 156, 105, 31, 38, 116, 82, 114, 26, 98, 5, 124, 43, 11, 6, 174, 46, 119, 18, 72, 223, 16, 243, 186, 53, 195, 46, 95, 3, 173, 71, 214, 100, 95, 51, 235, 23, 185, 139, 234, 122, 227, 79, 255, 28, 61, 208, 2, 89, 136, 197, 59, 163, 90, 84, 46, 110, 158, 10, 15, 184, 159, 88, 212, 154, 195, 39, 45, 13, 19, 230, 242, 166, 223, 43, 193, 41, 232, 3, 176, 242, 235, 66, 93, 46, 61, 71, 205, 41, 191, 70, 155, 50, 202, 124, 81, 182, 203, 91, 63, 54, 214, 168, 166, 20, 89]

it = start_addr
while it <= 0x1C47:
	if 0xf == idaapi.get_byte(it) and 0xb == idaapi.get_byte(it + 1):
		l = idaapi.get_byte(it+2)
		idaapi.patch_byte(it, 0x90)
		idaapi.patch_byte(it+1, 0x90)
		idaapi.patch_byte(it+2, 0x90) 
		it = it + 3
		for i in range(l):
			c = idaapi.get_byte(it + i)
			c = ((c & 0x8) >> 3) | ((c & 0x7) << 1) | ((c & 0x80) >> 3) | ((c & 0x70) << 1)
			c -= arr[i]
			if c < 0:
				c += 0x100
			idaapi.patch_byte(it + i, c)
		it += l
	else:
		it += 1